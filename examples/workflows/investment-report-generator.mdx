---
title: æŠ•èµ„æŠ¥å‘Šç”Ÿæˆå™¨
---
è¿™ä¸ªé«˜çº§ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªç»“åˆå¸‚åœºç ”ç©¶ã€è´¢åŠ¡åˆ†æå’ŒæŠ•èµ„ç»„åˆç®¡ç†çš„å¤æ‚æŠ•èµ„åˆ†æç³»ç»Ÿã€‚è¯¥å·¥ä½œæµç¨‹é‡‡ç”¨ä¸‰é˜¶æ®µæ–¹æ³•ï¼š
1. å…¨é¢çš„è‚¡ç¥¨åˆ†æä¸å¸‚åœºç ”ç©¶
2. æŠ•èµ„æ½œåŠ›è¯„ä¼°ä¸æ’å
3. æˆ˜ç•¥æ€§æŠ•èµ„ç»„åˆåˆ†é…å»ºè®®

æ ¸å¿ƒèƒ½åŠ›ï¼š
- å®æ—¶å¸‚åœºæ•°æ®åˆ†æ
- ä¸“ä¸šè´¢åŠ¡ç ”ç©¶
- æŠ•èµ„é£é™©è¯„ä¼°
- æŠ•èµ„ç»„åˆåˆ†é…ç­–ç•¥
- è¯¦ç»†æŠ•èµ„é€»è¾‘è¯´æ˜

ç¤ºä¾‹åˆ†æä¼ä¸šï¼š
- "AAPL, MSFT, GOOGL"ï¼ˆç§‘æŠ€å·¨å¤´ï¼‰
- "NVDA, AMD, INTC"ï¼ˆåŠå¯¼ä½“é¢†å†›ï¼‰
- "TSLA, F, GM"ï¼ˆæ±½è½¦åˆ›æ–°ï¼‰
- "JPM, BAC, GS"ï¼ˆé“¶è¡Œä¸šï¼‰
- "AMZN, WMT, TGT"ï¼ˆé›¶å”®ä¸šç«äº‰ï¼‰
- "PFE, JNJ, MRNA"ï¼ˆåŒ»ç–—å¥åº·ï¼‰
- "XOM, CVX, BP"ï¼ˆèƒ½æºè¡Œä¸šï¼‰

è¿è¡Œ`pip install openai yfinance agno`å®‰è£…ä¾èµ–é¡¹ã€‚

```python investment_report_generator.py
from pathlib import Path
from shutil import rmtree
from textwrap import dedent
from typing import Iterator

from agno.agent import Agent, RunResponse
from agno.storage.sqlite import SqliteStorage
from agno.tools.yfinance import YFinanceTools
from agno.utils.log import logger
from agno.utils.pprint import pprint_run_response
from agno.workflow import Workflow

reports_dir = Path(__file__).parent.joinpath("reports", "investment")
if reports_dir.is_dir():
    rmtree(path=reports_dir, ignore_errors=True)
reports_dir.mkdir(parents=True, exist_ok=True)
stock_analyst_report = str(reports_dir.joinpath("stock_analyst_report.md"))
research_analyst_report = str(reports_dir.joinpath("research_analyst_report.md"))
investment_report = str(reports_dir.joinpath("investment_report.md"))


class InvestmentReportGenerator(Workflow):
    """Advanced workflow for generating professional investment analysis with strategic recommendations."""

    description: str = dedent("""\
    An intelligent investment analysis system that produces comprehensive financial research and
    strategic investment recommendations. This workflow orchestrates multiple AI agents to analyze
    market data, evaluate investment potential, and create detailed portfolio allocation strategies.
    The system excels at combining quantitative analysis with qualitative insights to deliver
    actionable investment advice.
    """)

    stock_analyst: Agent = Agent(
        name="Stock Analyst",
        tools=[
            YFinanceTools(
                company_info=True, analyst_recommendations=True, company_news=True
            )
        ],
        description=dedent("""\
        You are MarketMaster-X, an elite Senior Investment Analyst at Goldman Sachs with expertise in:

        - Comprehensive market analysis
        - Financial statement evaluation
        - Industry trend identification
        - News impact assessment
        - Risk factor analysis
        - Growth potential evaluation\
        """),
        instructions=dedent("""\
        1. Market Research ğŸ“Š
           - Analyze company fundamentals and metrics
           - Review recent market performance
           - Evaluate competitive positioning
           - Assess industry trends and dynamics
        2. Financial Analysis ğŸ’¹
           - Examine key financial ratios
           - Review analyst recommendations
           - Analyze recent news impact
           - Identify growth catalysts
        3. Risk Assessment ğŸ¯
           - Evaluate market risks
           - Assess company-specific challenges
           - Consider macroeconomic factors
           - Identify potential red flags
        Note: This analysis is for educational purposes only.\
        """),
        expected_output="Comprehensive market analysis report in markdown format",
        save_response_to_file=stock_analyst_report,
    )

    research_analyst: Agent = Agent(
        name="Research Analyst",
        description=dedent("""\
        You are ValuePro-X, an elite Senior Research Analyst at Goldman Sachs specializing in:

        - Investment opportunity evaluation
        - Comparative analysis
        - Risk-reward assessment
        - Growth potential ranking
        - Strategic recommendations\
        """),
        instructions=dedent("""\
        1. Investment Analysis ğŸ”
           - Evaluate each company's potential
           - Compare relative valuations
           - Assess competitive advantages
           - Consider market positioning
        2. Risk Evaluation ğŸ“ˆ
           - Analyze risk factors
           - Consider market conditions
           - Evaluate growth sustainability
           - Assess management capability
        3. Company Ranking ğŸ†
           - Rank based on investment potential
           - Provide detailed rationale
           - Consider risk-adjusted returns
           - Explain competitive advantages\
        """),
        expected_output="Detailed investment analysis and ranking report in markdown format",
        save_response_to_file=research_analyst_report,
    )

    investment_lead: Agent = Agent(
        name="Investment Lead",
        description=dedent("""\
        You are PortfolioSage-X, a distinguished Senior Investment Lead at Goldman Sachs expert in:

        - Portfolio strategy development
        - Asset allocation optimization
        - Risk management
        - Investment rationale articulation
        - Client recommendation delivery\
        """),
        instructions=dedent("""\
        1. Portfolio Strategy ğŸ’¼
           - Develop allocation strategy
           - Optimize risk-reward balance
           - Consider diversification
           - Set investment timeframes
        2. Investment Rationale ğŸ“
           - Explain allocation decisions
           - Support with analysis
           - Address potential concerns
           - Highlight growth catalysts
        3. Recommendation Delivery ğŸ“Š
           - Present clear allocations
           - Explain investment thesis
           - Provide actionable insights
           - Include risk considerations\
        """),
        save_response_to_file=investment_report,
    )

    def run(self, companies: str) -> Iterator[RunResponse]:
        logger.info(f"Getting investment reports for companies: {companies}")
        initial_report: RunResponse = self.stock_analyst.run(companies)
        if initial_report is None or not initial_report.content:
            yield RunResponse(
                run_id=self.run_id,
                content="Sorry, could not get the stock analyst report.",
            )
            return

        logger.info("Ranking companies based on investment potential.")
        ranked_companies: RunResponse = self.research_analyst.run(
            initial_report.content
        )
        if ranked_companies is None or not ranked_companies.content:
            yield RunResponse(
                run_id=self.run_id, content="Sorry, could not get the ranked companies."
            )
            return

        logger.info(
            "Reviewing the research report and producing an investment proposal."
        )
        yield from self.investment_lead.run(ranked_companies.content, stream=True)


# å¦‚æœè„šæœ¬è¢«ç›´æ¥æ‰§è¡Œåˆ™è¿è¡Œå·¥ä½œæµç¨‹
if __name__ == "__main__":
    import random

    from rich.prompt import Prompt

    # ç¤ºä¾‹æŠ•èµ„åœºæ™¯å±•ç¤ºåˆ†æå™¨åŠŸèƒ½
    example_scenarios = [
        "AAPL, MSFT, GOOGL",  # Tech Giants
        "NVDA, AMD, INTC",  # Semiconductor Leaders
        "TSLA, F, GM",  # Automotive Innovation
        "JPM, BAC, GS",  # Banking Sector
        "AMZN, WMT, TGT",  # Retail Competition
        "PFE, JNJ, MRNA",  # Healthcare Focus
        "XOM, CVX, BP",  # Energy Sector
    ]

    # ä»ç”¨æˆ·å¤„è·å–å…¬å¸ä¿¡æ¯å¹¶æä¾›ç¤ºä¾‹å»ºè®®
    companies = Prompt.ask(
        "[bold]Enter company symbols (comma-separated)[/bold] "
        "(or press Enter for a suggested portfolio)\nâœ¨",
        default=random.choice(example_scenarios),
    )

    # å°†ä¼šè¯IDä¸­çš„å…¬å¸åç§°è½¬æ¢ä¸ºURLå®‰å…¨çš„å­—ç¬¦ä¸²
    url_safe_companies = companies.lower().replace(" ", "-").replace(",", "")

    # åˆå§‹åŒ–æŠ•èµ„åˆ†æå¸ˆå·¥ä½œæµç¨‹
    investment_report_generator = InvestmentReportGenerator(
        session_id=f"investment-report-{url_safe_companies}",
        storage=SqliteStorage(
            table_name="investment_report_workflows",
            db_file="tmp/agno_workflows.db",
        ),
    )

    # æ‰§è¡Œå·¥ä½œæµç¨‹
    report: Iterator[RunResponse] = investment_report_generator.run(companies=companies)

    # æ‰“å°æŠ¥å‘Š
    pprint_run_response(report, markdown=True)
```

## ä½¿ç”¨è¯´æ˜

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="å®‰è£…åº“">
    ```bash
    pip install openai yfinance agno
    ```
  </Step>

  <Step title="è¿è¡Œæ™ºèƒ½ä½“">
    ```bash
    python investment_report_generator.py
    ```
  </Step>

</Steps>