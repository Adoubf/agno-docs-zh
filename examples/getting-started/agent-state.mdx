---
title: æ™ºèƒ½ä½“çŠ¶æ€
---
æœ¬ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªåœ¨äº¤äº’è¿‡ç¨‹ä¸­ä¿æŒçŠ¶æ€çš„æ™ºèƒ½ä½“ã€‚è™½ç„¶æ¼”ç¤ºçš„æ˜¯ç®€å•çš„è®¡æ•°å™¨æœºåˆ¶ï¼Œä½†è¿™ç§æ¨¡å¼å¯æ‰©å±•è‡³æ›´å¤æ‚çš„çŠ¶æ€ç®¡ç†åœºæ™¯ï¼Œä¾‹å¦‚ç»´æŠ¤å¯¹è¯ä¸Šä¸‹æ–‡ã€ç”¨æˆ·åå¥½è®¾ç½®æˆ–è¿½è¸ªå¤šæ­¥éª¤æµç¨‹ã€‚

å¯å°è¯•çš„ç¤ºä¾‹æç¤ºï¼š
- "å°†è®¡æ•°å™¨é€’å¢3æ¬¡å¹¶å‘Šè¯‰æˆ‘æœ€ç»ˆæ•°å€¼"
- "å½“å‰è®¡æ•°æ˜¯å¤šå°‘ï¼Ÿå†å¢åŠ 2æ¬¡"
- "è®©æˆ‘ä»¬å°†è®¡æ•°å™¨é€’å¢5æ¬¡ï¼Œä½†è¯·å‘Šè¯‰æˆ‘æ¯ä¸ªæ­¥éª¤"
- "ç»™è®¡æ•°åŠ 4ï¼Œå¹¶æé†’æˆ‘åˆå§‹å€¼æ˜¯å¤šå°‘"
- "å°†è®¡æ•°å™¨å¢åŠ ä¸¤æ¬¡å¹¶æ€»ç»“æˆ‘ä»¬çš„æ“ä½œè¿‡ç¨‹"

## ä»£ç 

```python agent_state.py
from textwrap import dedent

from agno.agent import Agent
from agno.models.openai import OpenAIChat


# å®šä¹‰ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºé€’å¢è®¡æ•°å™¨å¹¶è¿”å›æ–°å€¼
def increment_counter(agent: Agent) -> str:
    """Increment the session counter and return the new value."""
    agent.session_state["count"] += 1
    return f"The count is now {agent.session_state['count']}"


# åˆ›å»ºä¸€ä¸ªç»´æŠ¤çŠ¶æ€çš„æ™ºèƒ½ä½“çŠ¶æ€ç®¡ç†å™¨
agent = Agent(
    model=OpenAIChat(id="gpt-4o"),
    # åˆå§‹åŒ–ä¼šè¯çŠ¶æ€ï¼Œå°†è®¡æ•°å™¨è®¾ç½®ä¸º0
    session_state={"count": 0},
    tools=[increment_counter],
    # ä½ å¯ä»¥åœ¨æŒ‡ä»¤ä¸­ä½¿ç”¨ä¼šè¯çŠ¶æ€ä¸­çš„å˜é‡
    instructions=dedent("""\
        You are the State Manager, an enthusiastic guide to state management! ğŸ”„
        Your job is to help users understand state management through a simple counter example.

        Follow these guidelines for every interaction:
        1. Always acknowledge the current state (count) when relevant
        2. Use the increment_counter tool to modify the state
        3. Explain state changes in a clear and engaging way

        Structure your responses like this:
        - Current state status
        - State transformation actions
        - Final state and observations

        Starting state (count) is: {count}\
    """),
    show_tool_calls=True,
    markdown=True,
)

# ç¤ºä¾‹ç”¨æ³•
agent.print_response(
    "Let's increment the counter 3 times and observe the state changes!",
    stream=True,
)

# æ›´å¤šç¤ºä¾‹æç¤ºè¯ä¾›å°è¯•ï¼š
"""
Try these engaging state management scenarios:
1. "Update our state 4 times and track the changes"
2. "Modify the counter twice and explain the state transitions"
3. "Increment 3 times and show how state persists"
4. "Let's perform 5 state updates with observations"
5. "Add 3 to our count and explain the state management concept"
"""

print(f"Final session state: {agent.session_state}")
```

## ä½¿ç”¨è¯´æ˜

<Steps>  
  <Snippet file="create-venv-step.mdx" />  

  <Step title="å®‰è£…åº“">  
    ```bash
    pip install openai agno
    ```  
  </Step>  

  <Step title="è¿è¡Œæ™ºèƒ½ä½“">  
    ```bash
    python agent_state.py
    ```  
  </Step>  

</Steps>